# Архитектурное решение по трейсингу

Системы которые необходимо покрыть трейсингом исходя ранее описанных проблем:
1. MES API. Исходя из жалоб на работу пользователей с внешнем API
2. MES Исходя из жалоб операторов  
3. Messages Queue. Возможно проблемы компонента MES API влияет на доставку ордеров CRM системе

## Мотивация 
Добавление трейсинга может решить следующие проблемы:
1. Наиболее быстро понять причины отказов в помеченных телеметрией компонентах, быстрее их исправить, и вернуться в нормальному функционированию системы не потеряв клиентов
2. Отслеживать узкие места на пути следования запросов. Определив узкие места мы можем их расширить и увеличить скорость обработки заказов
3. Быстро отследить места "потери" заказов, тем самым повысить качество обслуживания клиентов

## Предлагаемое решение
Для организации трейсинга будем использовать:
1. OpenTelemetry (OTel) - платформа наблюдения с открытым исходным кодом, которую будем встраивать в компоненты MES API, MES, Messages Queue
2. Jaeger — инструмент и для визуализации трассировок, который собирает и визуализирует информацию от OpenTelemetry
Модель решения в файле jewerly_c4_model_trace.drawio в текущей папке.

## Компромиссы
Трейсинг мы не будем использовать в следующих компонентах по следующим причинам:
1. Internet Shop, Shop API, так как не было жалоб на этот сервис со стороны пользователей. Проблемы были с невыполнением заказов, а не приемах. Если не планируется многократное увеличение заказов, необходимости в этом нет.
2. Компоненты СRM. От продавцов не поступало жалоб на работу системы. Трейсинг имеет смысл только при многократном увеличении заказов. Так же предполагаю, что CRM система это не наша разработка и возможно с закрытым кодом. Тогда встроить в нее OpenTelemetry будет не возможно
3. Хранилище 3D файлов. Считаю, что тут могут быть только проблемы переполнения или повреждения дисков, которые проще отследить на уровне логирования.

## Аспекты безопасности
Так как система находится в облаке, считаю что проблем с безопасностью внутренних подключений не возникнет. Считаю, что для обеспечения безопасности требуется только настройки безопасного подключения DevOps к Jagger UI. Думаю это можно реализовать на основе настроек безопасности доступа к облаку.

## Предлагаемое решение
Автоматический мониторинг будет настроен при помощи Jagger, который будет собирать данные. Управлять запросами к данным будем при помощи Jagger UI. Отметил эти компоненты в файле jewerly_c4_model_trace.drawio зеленым цветом.
